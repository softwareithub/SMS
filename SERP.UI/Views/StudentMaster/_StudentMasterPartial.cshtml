@model SERP.Core.Entities.Entity.Core.Transaction.StudentMaster
<script src="~/lib/jquery-validation/dist/jquery.validate.js"></script>
<script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.js"></script>
<link href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>

<section class="content-header">
    <h1>
        Student Master
        <small>Create Caste Detail</small>
    </h1>
    <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
        <li><a href="#">Forms</a></li>
        <li class="active">General Elements</li>
    </ol>
</section>


<section class="content">
    <div class="row">

        <div class="col-md-12">
            <!-- general form elements -->
            <div class="box box-primary">
                <div class="box-header with-border">
                    <h3 class="box-title">Create Student Master</h3>
                    <a class="btn btn-primary pull-right" onclick="GetList()">
                        <i class="fa fa-list-ul"></i>
                        List
                    </a>
                </div>
                <!-- /.box-header -->
                <!-- form start -->
                <form method="post" data-ajax="true" data-ajax-method="post"
                      asp-action="CreateStudent" asp-controller="StudentMaster" data-ajax-success="Success"
                      enctype="multipart/form-data">
                    <div class="box-body">
                        <div class="col-md-4">
                            <div class="form-group">
                                <input type="hidden" asp-for="Id" />
                                <input type="hidden" asp-for="CreatedBy" />
                                <input type="hidden" asp-for="CreatedDate" />
                                <label asp-for="Name">Student Name</label>
                                <input asp-for="Name" class="form-control" />
                                <span asp-validation-for="Name" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label asp-for="FatherName">Father Name</label>
                                <input asp-for="FatherName" class="form-control">
                                <span asp-validation-for="FatherName" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label asp-for="MotherName">Mother Name</label>
                                <input asp-for="MotherName" class="form-control">
                                <span asp-validation-for="MotherName" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label asp-for="FatherPhone">Father Phone</label>
                                <input asp-for="FatherPhone" class="form-control">
                                <span asp-validation-for="FatherPhone" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label asp-for="MotherPhone">Mother Phone</label>
                                <input asp-for="MotherPhone" class="form-control">
                                <span asp-validation-for="MotherPhone" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label asp-for="StudentEmail">Student Email</label>
                                <input asp-for="StudentEmail" class="form-control">
                                <span asp-validation-for="StudentEmail" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label asp-for="FatherEmail">Father Email</label>
                                <input asp-for="FatherEmail" class="form-control">
                                <span asp-validation-for="FatherEmail" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label asp-for="Gender">Gender</label>
                                <select asp-for="Gender" class="form-control">
                                    <option value="Sel">Select</option>
                                    <option value="Male">Male</option>
                                    <option value="Female">Fe-Male</option>
                                </select>
                                <span asp-validation-for="Gender" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label asp-for="BloodGroup">Blood Group</label>
                                <select asp-for="BloodGroup" class="form-control">
                                    <option value="">Select</option>
                                    <option value="A+">A+</option>
                                    <option value="A-">A-</option>
                                    <option value="A+">B+</option>
                                    <option value="A-">B-</option>
                                    <option value="A+">AB+</option>
                                    <option value="A-">AB-</option>
                                    <option value="A+">O+</option>
                                    <option value="A-">O-</option>
                                </select>
                                <span asp-validation-for="BloodGroup" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label asp-for="StudentPhone">Student Phone</label>
                                <input asp-for="StudentPhone" class="form-control" />
                                <span asp-validation-for="StudentPhone" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label asp-for="DateOfBirth">Date of Birth</label>
                                <input asp-for="DateOfBirth" class="form-control datepicker" />
                                <span asp-validation-for="DateOfBirth" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label asp-for="JoiningDate">Joining Date</label>
                                <input asp-for="JoiningDate" class="form-control datepicker" />
                                <span asp-validation-for="JoiningDate" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label asp-for="AcademicId">Academic Year</label>
                                <select asp-for="AcademicId" class="form-control" asp-items="@(new SelectList(ViewBag.AcademicList ,"Id","Name"))">
                                    <option value="">Select Academic Name</option>
                                </select>
                                <span asp-validation-for="AcademicId" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label asp-for="RegistrationNumber">Registration Number</label>
                                <input asp-for="RegistrationNumber" class="form-control" />
                                <span asp-validation-for="RegistrationNumber" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label asp-for="RollCode">Roll Code</label>
                                <input asp-for="RollCode" class="form-control" />
                                <span asp-validation-for="RollCode" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label asp-for="CourseId">Course Name</label>
                                <select asp-for="CourseId" class="form-control" asp-items="@(new SelectList(ViewBag.CourseList ,"Id","Name"))" onchange="GetBatchList()">
                                    <option value="">Select</option>
                                </select>
                                <span asp-validation-for="CourseId" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label asp-for="BatchId">Batch Name</label>
                                <select asp-for="BatchId" class="form-control">
                                    <option value="">Select</option>
                                </select>
                                <span asp-validation-for="BatchId" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label asp-for="FeeCategoryId">Category Name</label>
                                <select asp-for="FeeCategoryId" class="form-control" asp-items="@(new SelectList(ViewBag.CategoryList ,"Id","Name"))">
                                    <option value="">Select</option>
                                </select>
                                <span asp-validation-for="FeeCategoryId" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label asp-for="Religion">Religion Name</label>
                                <select asp-for="Religion" class="form-control" asp-items="@(new SelectList(ViewBag.ReligionList ,"Id","Name"))">
                                    <option value="">Select</option>
                                </select>
                                <span asp-validation-for="Religion" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label asp-for="P_Address">Permanent Address</label>
                                <input asp-for="P_Address" class="form-control" />
                                <span asp-validation-for="P_Address" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label asp-for="C_Address">Crosspondence Address</label>
                                <input asp-for="C_Address" class="form-control" />
                                <span asp-validation-for="C_Address" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label asp-for="StudentPhoto">Student Image</label>
                                <input type="file" asp-for="StudentPhoto" onchange="previewImage(this,'s')" class="form-control" />
                                <span asp-validation-for="StudentPhoto" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label asp-for="ParentsPhoto">Parents Image</label>
                                <input type="file" asp-for="ParentsPhoto" onchange="previewImage(this,'p')" class="form-control" />
                                <span asp-validation-for="ParentsPhoto" class="text-danger"></span>
                            </div>
                        </div>

                        <div class="col-md-12">
                            <div class="col-md-6">
                                <div class="form-group">
                                    @if (Model == null)
                                    {
                                        @Html.SerpImageHelper(null, 125, 125, "stdImage")
                                    }
                                    else
                                    {
                                        <input type="hidden" asp-for="StudentPhoto" />
                                        @Html.SerpImageHelper(Model.StudentPhoto, 125, 125, "stdImage")
                                    }
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    @if (Model == null)
                                    {
                                        @Html.SerpImageHelper(null, 125, 125, "parentImage")
                                    }
                                    else
                                    {
                                        <input type="hidden" asp-for="ParentsPhoto" />
                                        <input type="hidden" asp-for="BatchId"id="_hidenBatchId" />
                                        @Html.SerpImageHelper(Model.ParentsPhoto, 125, 125, "stdImage")
                                    }

                                </div>
                            </div>
                        </div>

                    </div>
                    <!-- /.box-body -->

                    <div class="box-footer">
                        <button type="submit" class="btn btn-primary pull-right" onclick="ValidateForm(this)">Submit</button>
                    </div>
                </form>
            </div>
        </div>

        <div class="modal fade" id="divModalPop" role="dialog">
            <div class="modal-dialog modal-dialog-centered  modal-lg">
                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title" style="text-align:center">Select Student List</h4>
                    </div><!--modal-header end-->

                    <div class="modal-body">
                        <fieldset class="fieldset marB0">
                            <div class="table-outer" style="min-height: 250px;" id="divPartialData">

                            </div>
                        </fieldset>
                    </div><!--modal-body end-->
                </div>
                <!--modal-content end-->
            </div><!--modal-dialog end-->
        </div>

    </div>
</section>

<script type="text/javascript">
    function GetList() {
        $.get("/StudentMaster/GetStudentList", function (response) {
            $("#divPartialData").html(response);
            $("#divModalPop").modal('show');
            setTimeout(function () {
                $("#tblDataList").DataTable({
                    fixedHeader: true,
                    select: true,
                    responsive: true
                });
            }, 300)
        });
    }

    function previewImage(input, type) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();

            reader.onload = function (e) {
                if (type === 's') {
                    $('#stdImage').attr('src', e.target.result);
                }
                else {
                    $('#parentImage').attr('src', e.target.result);
                }
            }
            reader.readAsDataURL(input.files[0]);
        }
    }

    $("#imgInp").change(function () {
        readURL(this);
    });

    function GetBatchList() {
        debugger;
        var courseId = $("#CourseId option:selected").val();
        $.get("/StudentMaster/GetBatchList", { courseId: courseId }, function (responseData) {
            $.each(responseData, function (index, value) {
                $('#BatchId').append($('<option></option>').text(value.batchName).attr('value', value.id));
            });
        });
    }

    function ValidateForm(e) {
        debugger;
        if ($("#AcademicName option:selected").val() == 0) {
            return false;
        }
        else {
            return true;
        }
    }

    $(document).ready(function () {
        GetBatchList();
        setTimeout(function () {
            $("#Batch").val($("#_hidenBatchId").val());
        }, 300)
    });

</script>